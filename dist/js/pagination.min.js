/*
 *  jQuery Pagination - v0.0.2
 *  JQuery plugin for paginated output of data with extra goodies.
 *  https://github.com/dreef3/jquery-paged
 *
 *  Made by Andrey Ermakov
 *  Under Apache License
 */
!function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,this.each(h?function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}:function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),1===arguments.length)return f[c]===b?null:f[c];f[c]=d}else{if(1===arguments.length)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a){"use strict";function b(a,b){b=b.split(".");for(var c=0;c<b.length;c++){if(!a)return null;a=a[b[c]]}return a}function c(a,b,c){b=b.split(".");for(var d;b.length>1&&(d=b.shift());)a=a[d]||(a[d]={});a[b.shift()]=c}function d(a,b){b=b.split(".");for(var c;b.length>1&&(c=b.shift());)if(a=a[c],!a)return;delete a[b.shift()]}a.widget("drf.pagination",{options:{page:1,limit:10,offset:0,total:null,template:null,pagesTemplate:null,url:null,data:null,pages:{attr:"data-page",total:5},css:{items:"pg-items",pages:"pg-pager",targets:{previous:"pg-previous",next:"pg-next",pageBefore:"pg-page-before",pageAfter:"pg-page-after",pageCurrent:"pg-page-current"}},keys:{root:"root",total:"total",limit:"limit",offset:"offset"},templateKeys:{array:"data",totalPages:"total",currentPage:"current",extra:"extra",limit:"limit",offset:"offset"},load:null,paginated:null,render:null,ajax:null},_create:function(){this._initComplete=!1,this._setOptions(this.options),this._initComplete=!0},_setTemplate:function(b){var c="_"+b;if(a.isFunction(this.options[b]))this[c]=this.options[b];else if(this.options[b]){if(void 0===_)throw new Error("Underscore.js wasn't found. It's a default template engine");this[c]=_.template(this.options[b])}},_setTotal:function(){var a=this.options.keys.total,c=this.options.keys.root;if(this._total=this.options.total,this._data){var d=b(this._data,c);this._total=this._total&&d.length<this._total?d.length:this._data[a]?this._data[a]:d.length}},_setPage:function(){if(this._limit=this.options.limit,this._offset=this.options.offset+this._limit*(this.options.page-1),this._total){var a=this.options.page,b=this.options.limit,c=this.options.offset,d=c+b*(a-1);this._total>d&&(this._total<d+b&&(b=this._total-d),this._currentPage=a,this._totalPages=Math.floor(this._total/this._limit),this._total%this._limit>0&&this._totalPages++,this.options.pages.total>this._totalPages&&(this.options.pages.total=this._totalPages),this._limit=b,this._offset=d)}},_setDataSource:function(a){this._reset(),this._load=a,this._initComplete&&this._load()},_validateOption:function(b,c){var d=!0;switch(b){case"limit":case"offset":case"total":d=a.isNumeric(c)&&c>=0;break;case"page":this._totalPages&&(d=a.isNumeric(c)&&c>0&&c<=this._totalPages);break;case"template":if(d=!!c,!d)throw new Error("Template wasn't set!")}return d},_setOption:function(a,b){if(this._validateOption(a,b))switch(this._super(a,b),a){case"template":this._setTemplate("template");break;case"pagesTemplate":this._setTemplate("pagesTemplate");break;case"page":this._setPage();break;case"limit":case"offset":this._setPage();break;case"total":this._setTotal();break;case"url":this._setDataSource(this._loadRemote);break;case"data":null!==b&&this._setDataSource(this._loadLocal)}},_setOptions:function(a){this._super(a),this.refresh()},_reset:function(){this._data=null,this._currentData=null,this._total=null},_destroy:function(){},_loadLocal:function(){this._saveData(this.options.data),this.refresh()},_loadRemote:function(){var b={url:this.options.url,type:"POST",dataType:"json",data:{}};b.data[this.options.keys.offset]=this._offset,b.data[this.options.keys.limit]=this._limit,this._trigger("ajax",null,b);var c=this;a.ajax(b).done(function(a){c._trigger("load",null,a),c._saveData(a),c.refresh()}).fail(function(){})},_setCurrentData:function(){var c=this.options.templateKeys,e=this.options.keys.root,f=b(this._data,e),g={};if(this._setTotal(),this._setPage(),!f||f.length<this._offset)return this._load(),!1;a.extend(!0,g,this._data),this._setPaginationData(g);var h=g[c.extra].pages,i=this._offset-h.before*this._limit,j=i+this._limit*(h.before+h.after+1);return g[c.array]=f.slice(i,j),g[c.offset]=h.before*this._limit,g[c.limit]=this._limit,d(g,e),this._trigger("paginated",null,g),this._currentData=g,!0},_setPaginationData:function(a){var b=this.options.templateKeys;a[b.currentPage]=this._currentPage,a[b.totalPages]=this._totalPages,a[b.extra]={pages:this.options.pages,css:this.options.css};var c=a[b.extra].pages;c.before=Math.floor(c.total/2),this._currentPage-c.before<=0&&(c.before=this._currentPage-1),c.after=c.total-c.before-1,this._totalPages-this._currentPage<c.after&&(c.after=this._totalPages-this._currentPage),c.after+c.before+1<c.total&&(c.before=c.total-c.after-1),c.first=1===this._currentPage,c.last=this._currentPage===this._totalPages},_createTargets:function(){var a={};return a[this.options.css.targets.previous]=this.previous,a[this.options.css.targets.next]=this.next,a[this.options.css.targets.pageBefore]=this.go,a[this.options.css.targets.pageAfter]=this.go,a},_bindTargets:function(){var b=this._createTargets(),c=this;a.each(b,function(b,d){a("."+b).each(function(){var b=a(this);b.click(function(a){a.preventDefault(),d.call(c,b.attr(c.options.pages.attr))})})})},_saveData:function(c){if(!c)throw new Error("Failed to retrieve data");if(a.isArray(c))this._saveArray(c);else{var d=this.options.keys.root;d&&c&&this._data&&a.isArray(b(c,d))&&a.isArray(b(this._data,d))?this._saveExistingObject(c):this._saveNewObject(c)}},_saveExistingObject:function(c){var d=this.options.keys.root,e=this.options.keys.offset,f=this.options.keys.limit,g=this._limit,h=this._offset;a.isNumeric(b(c,f))&&(g=parseInt(b(c,f),10)),a.isNumeric(b(c,e))&&(h=parseInt(b(c,e),10));var i=[h,g].concat(b(c,d));Array.prototype.splice.apply(b(this._data,d),i)},_saveArray:function(a){var d=this.options.keys.root;this._data=this._data||{},c(this._data,d,b(this._data,d)||[]);var e=b(this._data,d),f=a.length>this._limit?a.length:this._limit;e.splice([this._offset,f].concat(a))},_saveNewObject:function(c){var d=this.options.keys.root,e=b(c,d);a.isArray(e)||a.each(c,function(b,c){return d?(d=null,!1):(a.isArray(c)&&(d=b),!0)}),d&&(this.options.keys.root=d,this._data=a.extend(!0,{},c))},go:function(a){this._setOption("page",parseInt(a)),this.refresh()},forward:function(){this.go(this._currentPage+1)},back:function(){this.go(this._currentPage-1)},previous:function(){this.back()},next:function(){this.forward()},clear:function(){this._data=null},refresh:function(){if(this._setCurrentData()){this.element.html(this._template(this._currentData));var b=this;this._pagesTemplate&&this.element.find("."+this.options.css.pages).each(function(){a(this).html(b._pagesTemplate(b._currentData))}),this._bindTargets(),this._trigger("render",null,{element:this.element,data:a.extend(!0,{},this._currentData)})}}})}(jQuery);