/*
 *  jQuery Boilerplate - v3.3.1
 *  A jump-start for jQuery plugins development.
 *  http://jqueryboilerplate.com
 *
 *  Made by Zeno Rocha
 *  Under MIT License
 */
!function(a){function b(b,e){this.element=b,this.$element=a(b),this.settings=a.extend(!0,{},d,e),this._defaults=d,this._name=c,this.init()}var c="paged",d={render:null,_renderPager:null,template:"<ul><li>Nothing here yet</li></ul>",pagerTemplate:"<ul><% if (page > 1) { %><li><a href='#' class='paged-previous'><=</a></li><% for(var i = pagesBefore; i > 0; i--) { %><li><a href='#' class='paged-page-before' data-page='<%=page - i%>'><%=page - i%></a></li><% } %><% } %><li><a href='#' class='paged-current'><%=page%></a></li><% if (!isLast) { %><% for(var i = 1; i <= pagesAfter; i++) { %><li><a href='#' class='paged-page-after' data-page='<%=page + i%>'><%=page + i%></a></li><% } %><li><a href='#' class='paged-next'>=></a></li><% } %></ul>",events:{ready:null,afterRender:null,_load:null},targets:{previous:".paged-previous",next:".paged-next",page:".paged-page-before, .paged-page-after"},url:null,ajax:{},pages:{before:1,after:1},limit:10,offset:0,total:100,totalField:"total"};b.prototype={init:function(){if(!a.isFunction(this.settings.render)){if(this.settings.render=null,"undefined"==typeof _)throw new Error("Underscore was not found. Please include underscore.js OR provide a custom render function.");this._compiledTemplate=_.template(this.settings.template)}if(!a.isFunction(this.settings._renderPager)){if(this.settings._renderPager=null,"undefined"==typeof _)throw new Error("Underscore was not found. Please include underscore.js OR provide a custom render function.");this._compiledPagerTemplate=_.template(this.settings.pagerTemplate)}if(this.$element.html('<div class="paged"><div class="paged-items"></div><div class="paged-pager"></div></div>'),this.$container=a(".paged-items",this.element),this.$pager=a(".paged-pager",this.element),!this.settings.url)throw new Error("URL template was not set");this._compiledUrl=_.template(this.settings.url),this.settings.total&&this._evalTotalPages(),this.settings.offset-=this.settings.limit,this.forward()},_evalTotalPages:function(){this._totalPages=this.settings.total/this.settings.limit,this.settings.total%this.settings.limit>0&&this._totalPages++},forward:function(){this.settings.offset+=this.settings.limit;var a=this.settings.limit;this.settings.offset+a>this.settings.total&&(a=this.settings.total-this.settings.offset),this._load(this.settings.offset,a)},go:function(a){this.settings.offset=this.settings.limit*(a-1);var b=this.settings.limit;this.settings.offset+b>this.settings.total&&(b=this.settings.total-this.settings.offset),this._load(this.settings.offset,b)},back:function(){this.settings.offset-=this.settings.limit,this._load(this.settings.offset,this.settings.limit)},_load:function(b,c){var d=this._compiledUrl({offset:b,limit:c}),e=a.extend(!0,{},this.settings.ajax,{url:d,offset:b,limit:c,total:this.settings.total});a.ajax(e).done(function(a){this.settings.events.load&&this.settings.events.load(a),(!this.settings.total||a[this.settings.totalField])&&(this.settings.total=a[this.settings.totalField],this._evalTotalPages()),this._currentPage=b/c+1,this._isLastPage=b+c===this.settings.total,this._render(a),this._renderPager(),this.settings.afterRender&&this.settings.afterRender().call(this,this.element,a)}.bind(this)).fail(function(a,b,c){console.log(c)}.bind(this))},_renderPager:function(){var a=this.settings.pages.before;a>this._currentPage-1&&(a=this._currentPage-1);var b=this.settings.pages.after;b>this._totalPages-this._currentPage&&(b=this._totalPages-this._currentPage);var c={page:this._currentPage,isLast:this._isLastPage,pagesBefore:a,pagesAfter:b};this.$pager.children().remove(),this.settings._renderPager?this.$pager.html(this.settings._renderPager.apply(this,[c])):this.$pager.html(this._compiledPagerTemplate(c)),this._bindEvents()},_bindEvents:function(){var b=this;this.settings.targets.next&&a(this.settings.targets.next,this.$pager.get()).each(function(){a(this).click(function(){b.forward()})}),this.settings.targets.previous&&a(this.settings.targets.previous,this.$pager.get()).each(function(){a(this).click(function(){b.back()})}),this.settings.targets.page&&a(this.settings.targets.page,this.$pager.get()).each(function(){var c=a(this),d=c.attr("data-page");d&&a(this).click(function(){b.go(d)})})},_render:function(a){this.$container.children().remove(),this.settings.render?this.$container.html(this.settings.render.apply(this,[a])):this.$container.html(this._compiledTemplate(a))}},a.fn[c]=function(d){return this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(this,d))})}}(jQuery,window,document);